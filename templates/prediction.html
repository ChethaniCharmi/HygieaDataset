<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Prediction model</title>

	<link rel="stylesheet" href="{{ url_for('static', filename='prediction.css') }}" />
    <link rel="stylesheet" href="{{ url_for('static', filename='bootstrap.css') }}" />

</head>
<body>

    <div id="container-header" class="container-fluid">

        <div id="logo"><img src=""></div> 
        <h2>HYGIEIA <small>The Computational Intelligence</small></h2> 
        <div id="logout"> 
            <a href="/"> 
                <img src="static/logout.png" width="80px" height="80px"> 
            </a> 
        </div>
         

     </div>

     <div id="container-body" class="container-fluid">


        <form action="/predict" method="post" enctype="multipart/form-data" id="upload-form">
            <div class="chooseFile"><input type="file" id="imageInput" name="file" accept=".jpg, .png" class="btn btn-primary bg-dark text-white border none btn-lg"></div>

            <div class="predictBtn"><input type="submit" value="Make The Prediction" class="btn btn-primary bg-dark text-white border none btn-lg text-center "></div>

            <br>

            <!-- Image display area -->
            <div id="imagearea"><img id="uploadedImage"></div>



        </form>
        <div id="predictions"></div>

    <br>
         


     </div>
    

<script>


    //JavaScript to handle image upload and display ----------------------------------------------------------
    const imageInput = document.getElementById('imageInput');
    const uploadedImage = document.getElementById('uploadedImage');

    imageInput.addEventListener('change', function() {
        const file = imageInput.files[0];
        if (file) {
            const reader = new FileReader();
            reader.onload = function(e) {
                uploadedImage.src = e.target.result;
                uploadedImage.style.display = 'block';
                uploadedImage.style.width = '500px';
                uploadedImage.style.height = '500px';
            };
            reader.readAsDataURL(file);
        }
    });



    document.getElementById('upload-form').addEventListener('submit', function (e) {
        e.preventDefault(); // Prevent the form from submitting normally

        // Create a FormData object to send the uploaded file
        const formData = new FormData(this);

        // Sending the file to the server for prediction
        fetch('/predict', {
            method: 'POST',
            body: formData
        })
        .then(response => response.json())
        .then(data => {
            const predictions = data.predictions;
            const predictedClass = data.predicted_class; // Get the predicted class

            const predictionsDiv = document.getElementById('predictions');
            predictionsDiv.innerHTML = '<h2>Predictions:</h2>';
            
            // Display the predicted class
            predictionsDiv.innerHTML += `<p>Predicted Class: ${predictedClass}</p>`;
            
            // Display the probabilities for each class
            predictions.forEach((probability, index) => {
                predictionsDiv.innerHTML += `<p>Class ${index + 1}: ${probability}</p></br>`; //br ekak add kara
            });
        })
        .catch(error => console.error(error));
    });

   

</script>


</body>
</html>